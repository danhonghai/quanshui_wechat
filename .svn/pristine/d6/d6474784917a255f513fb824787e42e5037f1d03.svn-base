angular.module("money.controllers",[]).controller("MoneyCtrl",["$scope","$state","$ionicModal","$ionicScrollDelegate","Services","$ionicLoading","$timeout",function(e,t,o,a,n,i,s){e.postdata={interestRange:"",type:"",dueTime:"",status:"",name:"",orderBy:"",direction:"",page:0,size:10},e.moredata=!1;var r=[],c="noauth/getInvestmentListPc";localStorage.guide||t.go("guide"),e.BorrowTypes=angular.fromJson(sessionStorage.BorrowTypes),s(function(){new Swiper(".swiper-container",{slidesPerView:3.5,paginationClickable:!0,spaceBetween:0,freeMode:!0})},200),e.borrowstatefun=function(t,o){for(var n=0;n<e.BorrowTypes.length;n++)n==t?e.BorrowTypes[n].success=!0:e.BorrowTypes[n].success=!1;e.postdata.orderBy="",""==e.postdata.direction,e.postdata.type=o,e.postdata.page=0,r=[],e.loadMore(),a.scrollTop()},e.bcircleChartfun=function(e,t){0==t&&(t=null),$(".bcircleChart").eq(e).circleChart({size:52,value:t,text:0,textSize:14,color:"#ff304a",onDraw:function(e,t){t.text(Math.round(t.value)+"%")}})},e.searchbcircleChartfun=function(e,t){0==t&&(t=null),$(".searchbcircleChart").eq(e).circleChart({size:52,value:t,text:0,textSize:14,color:"#ff304a",onDraw:function(e,t){t.text(Math.round(t.value)+"%")}})},e.sortfun=function(t){"percentage"!=t?""==e.postdata.direction||"asc"==e.postdata.direction?e.postdata.direction="desc":e.postdata.direction="asc":""==e.postdata.direction||"desc"==e.postdata.direction?e.postdata.direction="asc":e.postdata.direction="desc",t!=e.postdata.orderBy&&(e.postdata.orderBy=t,""==e.postdata.direction),e.postdata.page=0,r=[],e.loadMore(),a.scrollTop()},e.doRefresh=function(){e.postdata.page=0,r=[],e.loadMore()},e.loadMore=function(){n.ionicLoading(),e.postdata.page+=1,n.getReturnData(c,e.postdata).then(function(t){if(i.hide(),"0000"==t.data.code||"1010"==t.data.code||"1000"==t.data.code){r=r.concat(t.data.data.investmentList.content),e.borrowlists=r;var o=t.data.data.investmentList.content.length;o<e.postdata.size?e.moredata=!0:e.moredata=!1,e.$broadcast("scroll.infiniteScrollComplete"),e.$broadcast("scroll.refreshComplete")}else n.ionicpopup("",t.msg)},function(o){return i.hide(),"401"==o.status?(e.optionsPopup=$ionicPopup.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",t.go("login")}}]}),!1):void n.ionicpopup("","错误500<br>"+o.data.message)})},e.prolisttit=[{name:"理财",success:!0,url:"noauth/getInvestmentListPc"}],e.protittopfc=function(t){a.scrollTop(),e.postdata={interestRange:"",type:"",dueTime:"",status:"",name:"",orderBy:"",direction:"",page:0,size:10},c=e.prolisttit[t].url;for(var o=0,n=e.prolisttit.length;o<n;o++)t===o?e.prolisttit[o].success=!0:e.prolisttit[o].success=!1;e.postdata.page=0,r=[],e.loadMore()},e.goprodetail=function(e){t.go("prodetail",{proid:e,curside:"1"})},e.protittopfc(0),e.searchpostdata={interestRange:"",type:"",dueTime:"",status:"",name:"",orderBy:"",direction:"",page:1,size:9999},e.searchmoredata=!1}]).controller("ProdetailCtrl",["$scope","$state","$stateParams","$ionicModal","Services","$ionicScrollDelegate","$timeout",function(e,t,o,a,n,i,s){e.prolisttit=[{name:"项目概况",success:!0},{name:"风险控制",success:!1},{name:"还款计划",success:!1},{name:"投资记录",success:!1}],n.getServerTime(function(a){if(e.nowtime=a,e.isFinancing=!0,o.proid){var i={borrowId:o.proid};n.getData("noauth/showOneBorrow",1,i,function(t){n.console(t),e.prodetail=t.data.borrowInfo}),e.buyfinancialfun=function(){t.go("buyfinancial",{id:o.proid,curside:o.curside})}}n.getData("noauth/purchaseRecord",1,{borrowId:o.proid,pageNumber:1,pageSize:99999},function(t){n.console(t),e.tzjl=t.data.articles})}),e.protittopfc=function(t){i.scrollTop();for(var o=0,a=e.prolisttit.length;o<a;o++)t===o?e.prolisttit[o].success=!0:e.prolisttit[o].success=!1},e.gopropay=function(){sessionStorage.userinfo?t.go("propay",{proid:o.proid,transferRegisterRid:o.transferRegisterRid,curside:o.curside}):t.go("login")},e.gocalculator=function(){t.go("calculator",{proid:o.proid})},a.fromTemplateUrl("my-modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.modal=t}),e.openModal=function(){e.modal.show()},e.closeModal=function(){e.modal.hide()},e.$on("$destroy",function(){e.modal.remove()}),e.$on("$ionicView.leave",function(){e.modal.hide()})}]).controller("PropayCtrl",["$scope","$state","$stateParams","$ionicPopup","MyServices","Services","$ionicLoading","$ionicPopover",function(e,t,o,a,n,i,s,r){i.ionicLoading();angular.fromJson(sessionStorage.userinfo);if(e.prodetail={},e.returndata={},e.debxdata=0,$(".progress-bar").width(e.prodetail.yitou),e.data={},o.proid){var c={borrowId:o.proid};i.getData("noauth/showOneBorrow",1,c,function(o){s.hide(),i.console(o),e.data=o.data.borrowInfo,$(".progress-bar").width(100*e.data.planRat+"%"),$(".progress-bar").css({animation:"animate-positive 2s"}),e.popover=r.fromTemplateUrl("my-popover.html",{scope:e}),r.fromTemplateUrl("my-popover.html",{scope:e}).then(function(t){e.popover=t}),e.myFunc=function(){var t=e.data.apr/100/12;e.debxdata=e.returndata.money*t*[Math.pow(1+t,e.data.timeLimit)]/([Math.pow(1+t,e.data.timeLimit)]-1)*e.data.timeLimit-e.returndata.money},e.openPopover=function(t){e.returndata.money?e.returndata.money>=e.data.lowestAccount?e.popover.show(t):i.ionicLoading(2e3,"投资金额必须大于等于"+e.data.lowestAccount):i.ionicLoading(2e3,"请输入投资金额")},e.closePopover=function(){e.popover.hide()},e.$on("$destroy",function(){e.popover.remove()}),e.$on("popover.hidden",function(){}),e.$on("popover.removed",function(){});var n={status:0,pageSize:99999,pageNumber:1};i.getReturnData("my_red_coupon",n).then(function(t){if(s.hide(),i.console(t),"0000"==t.data.code||"1010"==t.data.code||"1000"==t.data.code){e.redblists=t.data.data.redCouponList?t.data.data.redCouponList:[];for(var o=[],a=0;a<e.redblists.length;a++)o.push({text:e.redblists[a].money+"元",value:e.redblists[a].id});var n=document.getElementById("redb"),r=new Picker({data:[o]});r.on("picker.select",function(e,t){n.innerText=o[t[0]].text}),r.on("picker.change",function(e,t){}),r.on("picker.valuechange",function(t,o){e.choiceredmoney=parseInt(e.redblists[o[0]].money),e.returndata.hongbaoId=t[0]}),r.on("picker.cancel",function(){e.choiceredmoney=0,e.returndata.hongbaoId="",n.innerText="点击选择"}),n.addEventListener("click",function(){r.show()})}else i.ionicpopup("",t.msg)},function(o){return s.hide(),i.console(o),"401"==o.status?(e.optionsPopup=a.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",t.go("login")}}]}),!1):void i.ionicpopup("","错误500<br>"+o.data.message)}),i.getReturnData("my_coupon",n).then(function(t){if(i.console(t),"0000"==t.data.code||"1010"==t.data.code||"1000"==t.data.code){e.raiselists=t.data.data.couponList?t.data.data.couponList:[];for(var o=[],a=0;a<e.raiselists.length;a++)o.push({text:e.raiselists[a].money+"%",value:e.raiselists[a].id});var n=document.getElementById("select_jxq"),s=new Picker({data:[o]});s.on("picker.select",function(e,t){n.innerText=o[t[0]].text}),s.on("picker.change",function(e,t){}),s.on("picker.valuechange",function(t,o){e.returndata.couponId=t[0]}),s.on("picker.cancel",function(){e.returndata.couponId="",n.innerText="点击选择"}),n.addEventListener("click",function(){s.show()})}else i.ionicpopup("",t.msg)},function(o){return i.console(o),"401"==o.status?(e.optionsPopup=a.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",t.go("login")}}]}),!1):void i.ionicpopup("","错误500<br>"+o.data.message)})}),e.surepay=function(){i.ionicLoading(),e.returndata.borrowId=o.proid,i.getData("borrow/tender",1,e.returndata,function(o){i.console(o),s.hide(),"0000"==o.code?(e.closePopover(),e.optionsPopup=a.show({template:"<img width='70' src='img/icon_register.png' /><h4>投资成功</h4><p>坐等收钱吧！</p>",title:"温馨提示",scope:e,buttons:[{text:"继续投资",type:"calm",onTap:function(e){t.go("tab.money")}},{text:"查看订单",type:"calm",onTap:function(e){t.go("financial")}}]})):(s.hide(),i.ionicpopup("",o.data.fymsg))})}}e.gocalculator=function(){t.go("calculator",{proid:o.proid})}}]).controller("CalculatorCtrl",["$scope","$state","$stateParams","Services",function(e,t,o,a){if(e.prodetail={},e.arrqs=[],e.data={},e.lixis=[],e.debxdata=0,o.proid){var n={borrowId:o.proid};a.getData("noauth/showOneBorrow",1,n,function(t){if(a.console(t),e.prodetail=t.data.borrowInfo,0==e.prodetail.isDay)for(var o=0;o<e.prodetail.timeLimit;o++)e.arrqs.push(o);e.myFunc=function(){function t(e,t){for(var o=e;t-- >1;)o*=e;return o}var o=e.data.jsqtzmoney,a=e.prodetail.apr/100/12,n=0,i=0,s=0,r=e.prodetail.timeLimit,c=0,d=0;n=o*a*t(1+a,r)/(t(1+a,r)-1),d=n*r,e.lixis=[];for(var u=0;u<r;u++)i=0==u?o:e.lixis[u-1][3],s=i*a,c+=s,e.lixis.push([s,n-s,n,i-(n-s)]);e.debxdata=o*a*[Math.pow(1+a,e.prodetail.timeLimit)]/([Math.pow(1+a,e.prodetail.timeLimit)]-1)*e.prodetail.timeLimit-o,console.log(e.debxdata)}})}}]),angular.module("my.controllers",[]).controller("MyCtrl",["$scope","$state","$ionicHistory","$ionicPopup","Services","$ionicLoading",function(e,t,o,a,n,i){localStorage.guide||t.go("guide"),n.ionicLoading(),e.userInfo={},e.userAccount={},e.userCredit={},e.showacc=!0,sessionStorage.token?(n.getDataget("showAccount","",function(t){n.console(t),i.hide(),e.userInfo=t.data.userInfo,e.userAccount=t.data.userAccount,e.userCredit=t.data.userCredit,e.userInfo.kyhb=t.data.kyhb,e.userInfo.kyjx=t.data.kyjx,sessionStorage.userinfo=angular.toJson(t.data.userInfo)}),e.gomyticket=function(e){t.go("myticket",{index:e})}):(i.hide(),e.optionsPopup=a.show({template:"暂未登录，请先登录",title:"温馨提示",scope:e,buttons:[{text:"返回",onTap:function(e){o.goBack()}},{text:"登录",type:"calm",onTap:function(e){t.go("login")}}]})),e.$on("$ionicView.afterEnter",function(){})}]).controller("LoginCtrl",["$scope","$rootScope","Services","$ionicPopup","$ionicLoading","$state","$stateParams","$interval","$ionicModal",function(e,t,o,a,n,i,s,r,c){console.log(s.inviteCode),e.data={},e.passdata={},e.regdata={},e.forpassdata={},e.logintabtit=[{name:"登入",success:!0},{name:"注册",success:!1}],e.logintabfun=function(t){for(var o=0,a=e.logintabtit.length;o<a;o++)t===o?e.logintabtit[o].success=!0:e.logintabtit[o].success=!1},e.getphoneCodefun=function(){if(e.regdata.userName){var a={userName:e.regdata.userName,type:1};o.getData("noauth/sendMessage",1,a,function(e){o.console(e),t.timer(60,"#sendButton_reg")})}else o.ionicLoading(2e3,"请输入手机号")},s.inviteCode&&(e.regdata.inviteCode=s.inviteCode),e.register=function(){e.regdata.userType=1,o.getData("noauth/userRegister",1,e.regdata,function(n){var s={userName:e.regdata.userName,password:e.regdata.password};o.getData("noauth/userLogin",1,s,function(e){o.console(e),"0000"==e.code?(sessionStorage.token=e.data.token,t.tokentime=r(function(){o.getDataget("refreshToken","",function(e){o.console(e),"0000"==e.code&&(o.console(e.data.token),sessionStorage.token=e.data.token)})},6e5),i.go("tab.my")):o.ionicLoading(2e3,n.msg)}),e.optionsPopup=a.show({template:"<img width='70' src='img/icon_register.png' /><h4>注册成功</h4><p>完成三方认证，即可投资</p>",title:"温馨提示",scope:e,buttons:[{text:"先逛逛",onTap:function(e){i.go("tab.home")}},{text:"去认证",type:"calm",onTap:function(e){i.go("certification")}}]})})},e.login=function(){o.ionicLoading(),o.getData("noauth/userLogin",1,e.data,function(e){o.console(e),n.hide(),"0000"==e.code?(sessionStorage.token=e.data.token,t.tokentime=r(function(){o.getDataget("refreshToken","",function(e){o.console(e),"0000"==e.code&&(o.console(e.data.token),sessionStorage.token=e.data.token)})},6e5),i.go("tab.my")):o.ionicLoading(2e3,e.msg)})},c.fromTemplateUrl("my-modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.modal=t}),e.openModal=function(){e.modal.show()},e.closeModal=function(){e.modal.hide()},e.$on("$destroy",function(){e.modal.remove()}),e.$on("$ionicView.leave",function(){e.modal.hide()})}]).controller("ForgotpassCtrl",["$scope","$rootScope","Services","$ionicPopup","$ionicLoading","$state",function(e,t,o,a,n,i){e.data={},e.getphoneCodefun=function(){if(e.data.userName){o.ionicLoading();var i={userName:e.data.userName,type:2};o.getData("noauth/sendMessage",1,i,function(i){n.hide(),"0000"==i.code?(t.timer(60,"#sendButton_reg"),e.optionsPopup=a.show({template:"发送成功",title:"温馨提示",scope:e,buttons:[{text:"确定"}]})):o.ionicLoading(2e3,i.msg)})}else o.ionicLoading(2e3,"请输入手机号")},e.backPassword=function(){o.ionicLoading(),o.getData("noauth/forgetPassword",1,e.data,function(t){n.hide(),"0000"==t.code?e.optionsPopup=a.show({template:"密码找回成功",title:"温馨提示",scope:e,buttons:[{text:"确定"}]}):o.ionicLoading(2e3,t.msg)})}}]).controller("RechargeCtrl",["$scope","$state","$timeout","$ionicModal","Services","$ionicLoading",function(e,t,o,a,n,i){e.data={},e.userinfo=angular.fromJson(sessionStorage.userinfo),e.rechargebtn=function(){e.data.amount?(n.ionicLoading(),n.console(e.data),n.getData("userRecharge",10,e.data,function(t){n.console(t),e.submitdata=t.data.rechargeMap,o(function(){i.hide(),document.getElementById("rechargeForm").submit()},500),e.modal.show()})):n.ionicLoading(2e3,"请输入投资金额")},e.clearmoney=function(){e.data.amount=""},a.fromTemplateUrl("templates/modal.html",{scope:e}).then(function(t){e.modal=t}),e.rechargelist=function(e){t.go("rechargelist",{index:2})}}]).controller("RechargelistCtrl",["$scope","Services","$ionicScrollDelegate","$ionicPopup","$state","$stateParams",function(e,t,o,a,n,i){e.pageNumber=0,e.pageSize=10,e.pointType=1,e.moredata=!1,e.findetailslists=[{name:"全部",success:!0},{name:"收入",success:!1},{name:"支出",success:!1}];var s=[];e.findetailsfun=function(t){e.pageNumber=0,s=[],e.pointType=t,o.scrollTop();for(var a=0;a<e.findetailslists.length;a++)a==t-1?e.findetailslists[a].success=!0:e.findetailslists[a].success=!1;e.loadMore()},e.doRefresh=function(){e.pageNumber=0,s=[],e.loadMore()},e.loadMore=function(){e.pageNumber+=1;var o={userAccountType:e.pointType,pageSize:e.pageSize,pageNumber:e.pageNumber};t.getReturnData("userMoneyDetails",o).then(function(o){if(t.console(o),"0000"==o.data.code||"1010"==o.data.code||"1000"==o.data.code){t.console(o.data.data.list),s=s.concat(o.data.data.list),e.pointdetails=s;for(var a=0;a<e.pointdetails.length;a++)e.pointdetails[a].success=!1;var n=o.data.data.list.length;n<e.pageSize?e.moredata=!0:e.moredata=!1,e.$broadcast("scroll.infiniteScrollComplete"),e.$broadcast("scroll.refreshComplete")}else t.ionicpopup("",o.msg)},function(o){return t.console(o),"401"==o.status?(e.optionsPopup=a.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",n.go("login")}}]}),!1):void t.ionicpopup("","错误"+o.status+"<br>"+o.data.message)})},i.index&&e.findetailsfun(i.index),e.showacdetail=function(t){for(var o=0;o<e.pointdetails.length;o++)o==t?e.pointdetails[o].success=!0:e.pointdetails[o].success=!1}}]).controller("WithdrawalCtrl",["$scope","$state","$timeout","$ionicModal","Services","$ionicLoading",function(e,t,o,a,n,i){e.data={},e.userinfo=angular.fromJson(sessionStorage.userinfo),e.withdrawalbtn=function(){e.data.amount?(n.ionicLoading(),n.console(e.data),n.getData("userWithdraw",10,e.data,function(t){n.console(t),e.submitdata=t.data.withdrawMap,o(function(){i.hide(),document.getElementById("rechargeForm").submit()},500),e.modal.show()})):n.ionicLoading(2e3,"请输入提现金额")},e.clearmoney=function(){e.data.amount=""},a.fromTemplateUrl("templates/modal.html",{scope:e}).then(function(t){e.modal=t}),e.rechargelist=function(e){t.go("rechargelist",{index:3})}}]).controller("MyuserCtrl",["$scope","$ionicModal","Services","$ionicPopup","$state",function(e,t,o,a,n){e.userInfosession=angular.fromJson(sessionStorage.userinfo),$(function(){$("#clipArea").photoClip({width:200,height:200,file:"#file",view:"#view",ok:"#clipBtn",clipFinish:function(e){}}),$("#logox").click(function(){$(".htmleaf-container").show(),$(".htmleaf-container").height($(window).height())}),$("#clipBtn").click(function(){$(".htmleaf-container").hide();var t=imgsource.split(",")[1];if(t){var a={base64Str:t,fileName:"1.jpg"};o.getData("photoUpload",1,a,function(t){o.console(t),e.userInfosession.litpic=t.data.url,$(".myuser_top").css("background","url("+t.data.url+")")})}})});e.setImagePreview=function(){var e,t,o,a=document.getElementById("file_head"),n=a.value;if(!n.match(/.jpg|.png/i))return alert("您上传的图片格式不正确，请重新选择！"),!1;if(e=document.getElementById("preview"),a.files&&a.files[0])e.style.display="block",e.style.width="63px",e.style.height="63px",e.src=window.navigator.userAgent.indexOf("Chrome")>=1||window.navigator.userAgent.indexOf("Safari")>=1?window.webkitURL.createObjectURL(a.files[0]):window.URL.createObjectURL(a.files[0]);else{a.select(),a.blur(),t=document.selection.createRange().text,o=document.getElementById("localImag"),o.style.width="63px",o.style.height="63px";try{o.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)",o.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=t}catch(i){return alert("您上传的图片格式不正确，请重新选择！"),!1}e.style.display="none",document.selection.empty()}return document.getElementById("DivUp").style.display="block",!0}}]).controller("PaymentmanageCtrl",["$scope","$timeout",function(e,t){e.prolisttit=[{name:"默认",success:!0},{name:"近7天",success:!1},{name:"近1个月",success:!1},{name:"近2个月",success:!1},{name:"近6个月",success:!1},{name:"近1年",success:!1}],t(function(){new Swiper(".swiper-container",{pagination:".swiper-pagination",slidesPerView:4,paginationClickable:!0,spaceBetween:0,freeMode:!0})},500),e.protittopfc=function(t){for(var o=0,a=e.prolisttit.length;o<a;o++)t===o?e.prolisttit[o].success=!0:e.prolisttit[o].success=!1}}]).controller("BorrowmanageCtrl",["$scope","Services","$ionicPopup","$state",function(e,t,o,a){e.pageNumber=0,e.pageSize=10,e.moredata=!1,e.borrowTenderType=1;var n=[];e.borrowstatelists=[{name:"进行中",success:!0},{name:"待还款",success:!1},{name:"逾期中",success:!1},{name:"已完结",success:!1}],e.borrowstatefun=function(t){e.pageNumber=0,n=[],e.borrowTenderType=t+1;for(var o=0;o<e.borrowstatelists.length;o++)o==t?e.borrowstatelists[o].success=!0:e.borrowstatelists[o].success=!1;e.loadMore()},e.doRefresh=function(){e.pageNumber=0,n=[],e.loadMore()},e.loadMore=function(){e.pageNumber+=1;var i={borrowtype:e.borrowTenderType,pageSize:e.pageSize,pageNumber:e.pageNumber};t.getReturnData("userBorrowPage",i).then(function(o){if(t.console(o),"0000"==o.data.code||"1010"==o.data.code||"1000"==o.data.code){t.console(o.data.data.list),n=n.concat(o.data.data.list),e.pointdetails=n;var a=o.data.data.list.length;a<e.pageSize?e.moredata=!0:e.moredata=!1,e.$broadcast("scroll.infiniteScrollComplete"),e.$broadcast("scroll.refreshComplete")}else t.ionicpopup("",o.msg)},function(n){return t.console(n),"401"==n.status?(e.optionsPopup=o.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",a.go("login")}}]}),!1):void t.ionicpopup("","错误"+n.status+"<br>"+n.data.message)})},e.repaylink=function(e,t){console.log(t),a.go("repayments",{repaymentId:e,lateid:t})}}]).controller("RepaymentsCtrl",["$scope","Services","$ionicPopup","$state","$stateParams","$ionicLoading",function(e,t,o,a,n,i){t.ionicLoading(),e.data={};var s={repaymentId:n.repaymentId};t.getData("repaymentDetails",1,s,function(o){t.console(o),i.hide(),e.data=o.data.repaymentDetails}),e.gorepaylist=function(){a.go("repaymentlists",{repaymentId:n.repaymentId})},e.repayfun=function(){t.ionicLoading(),0==n.lateid?t.getData("repayment",1,s,function(n){t.console(n),i.hide(),e.optionsPopup=o.show({template:"还款成功",title:"温馨提示",scope:e,buttons:[{text:"返回",type:"calm",onTap:function(e){a.go("borrowmanage")}}]})}):t.getData("overdueRepayment",1,s,function(n){t.console(n),i.hide(),e.optionsPopup=o.show({template:"还款成功",title:"温馨提示",scope:e,buttons:[{text:"返回",type:"calm",onTap:function(e){a.go("borrowmanage")}}]})})}}]).controller("RepaymentlistsCtrl",["$scope","Services","$ionicPopup","$state","$stateParams",function(e,t,o,a,n){e.data={};var i={repaymentId:n.repaymentId};t.getData("repaymentList",1,i,function(o){t.console(o),e.borrowName=o.data.borrowName,e.data=o.data.list})}]).controller("FinancialCtrl",["$scope","Services","$ionicPopup","$state",function(e,t,o,a){e.pageNumber=0,e.pageSize=10,e.moredata=!1,e.borrowTenderType=1;var n=[];e.borrowstatelists=[{name:"进行中",success:!0},{name:"还款中",success:!1},{name:"逾期中",success:!1},{name:"已完结",success:!1}],e.borrowstatefun=function(t){e.pageNumber=0,n=[],e.borrowTenderType=t+1;for(var o=0;o<e.borrowstatelists.length;o++)o==t?e.borrowstatelists[o].success=!0:e.borrowstatelists[o].success=!1;e.loadMore()},e.doRefresh=function(){e.pageNumber=0,n=[],e.loadMore()},e.loadMore=function(){e.pageNumber+=1;var i={borrowTenderType:e.borrowTenderType,pageSize:e.pageSize,pageNumber:e.pageNumber};t.getReturnData("userTenderPage",i).then(function(o){if(t.console(o),"0000"==o.data.code||"1010"==o.data.code||"1000"==o.data.code){t.console(o.data.data.list),n=n.concat(o.data.data.list),e.pointdetails=n;var a=o.data.data.list.length;a<e.pageSize?e.moredata=!0:e.moredata=!1,e.$broadcast("scroll.infiniteScrollComplete"),e.$broadcast("scroll.refreshComplete")}else t.ionicpopup("",o.msg)},function(n){return t.console(n),"401"==n.status?(e.optionsPopup=o.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",a.go("login")}}]}),!1):void t.ionicpopup("","错误"+n.status+"<br>"+n.data.message)})}}]).controller("MyticketCtrl",["$scope","Services","$ionicScrollDelegate","$ionicPopup","$state","$stateParams","$ionicLoading",function(e,t,o,a,n,i,s){e.pageNumber=0,e.pageSize=10,e.pointType=0,e.posturl="my_red_coupon",e.moredata=!1;var r=[];e.prolisttit=[{name:"红包",success:!0},{name:"加息券",success:!1}],e.borrowstatelists=[{name:"未使用",success:!0},{name:"已使用",success:!1},{name:"已过期",success:!1},{name:"已冻结",success:!1}],e.redblists=[],e.raiselists=[],e.functionId="";angular.fromJson(sessionStorage.userinfo);e.showticketlists=[],e.protittopfc=function(t){e.pageNumber=0,e.pointType=0,r=[],0==t?e.posturl="my_red_coupon":e.posturl="my_coupon";for(var o=0,a=e.prolisttit.length;o<a;o++)t==o?e.prolisttit[o].success=!0:e.prolisttit[o].success=!1;for(var o=0,a=e.borrowstatelists.length;o<a;o++)0==o?e.borrowstatelists[o].success=!0:e.borrowstatelists[o].success=!1;e.loadMore()},e.borrowstatefun=function(t){e.pageNumber=0,r=[],0==t?e.pointType=0:1==t?e.pointType=1:2==t?e.pointType=3:3==t&&(e.pointType=4),o.scrollTop();for(var a=0;a<e.borrowstatelists.length;a++)a==t?e.borrowstatelists[a].success=!0:e.borrowstatelists[a].success=!1;e.loadMore()},e.doRefresh=function(){e.pageNumber=0,r=[],e.loadMore()},e.loadMore=function(){t.ionicLoading(),e.pageNumber+=1;var o={status:e.pointType,pageSize:e.pageSize,pageNumber:e.pageNumber};t.getReturnData(e.posturl,o).then(function(o){if(s.hide(),t.console(o),"0000"==o.data.code||"1010"==o.data.code||"1000"==o.data.code){if(e.prolisttit[0].success){r=r.concat(o.data.data.redCouponList),e.redpackets=r;var a=o.data.data.redCouponList.length}else{r=r.concat(o.data.data.couponList),e.redpackets=r;var a=o.data.data.couponList.length}a<e.pageSize?e.moredata=!0:e.moredata=!1,e.$broadcast("scroll.infiniteScrollComplete"),e.$broadcast("scroll.refreshComplete")}else t.ionicpopup("",o.msg)},function(o){return s.hide(),t.console(o),"401"==o.status?(e.optionsPopup=a.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",n.go("login")}}]}),!1):void t.ionicpopup("","错误500<br>"+o.data.message)})},i.index?e.protittopfc(i.index):e.protittopfc(0)}]).controller("MypointsCtrl",["$scope","$timeout","$stateParams","Services","$ionicLoading","$ionicModal",function(e,t,o,a,n,i){function s(e,t){for(var o=e.length;o--;)if(e[o]===t)return!0;return!1}a.ionicLoading();var r="yqd",d=angular.fromJson(sessionStorage.userinfo),u=new Date;e.qddataarr=[],e.datatextlist=[],e.day=u.getDate(),e.continuousopint=0,e.pointstate={name:"签到",success:!1},e.year=u.getFullYear(),e.month=u.getMonth()+1;var l=u.getMonth()+1,p=u.getFullYear(),g={userId:d.id,year:"",month:""},f=new Date,h=new Date(f.getFullYear(),f.getMonth()+1,0).getDate();({userId:d.id,userNo:d.userNo});a.getDataget("showAccount","",function(t){a.console(t),e.userUserInfoData=t.data.userCredit}),e.getqdlist=function(t,o){u=new Date(t,o,0),u.setDate(1);var i=u.getDay();h=new Date(u.getFullYear(),u.getMonth()+1,0).getDate(),g.year=t,g.month=o,a.getData("signLog",1,g,function(a){if(n.hide(),"0000"==a.code)for(e.datatextlist=[],e.continuousopint=a.data.signDays,c=a.data.signNums,e.rules=a.data.list.concat(a.data.list1),m=0;m<h+i;m++)if(m>=i){var d=m-i+1;e.day==d&&l==o&&p==t?(r="dq",s(c,d)?e.pointstate={name:"已签到",success:!0}:e.pointstate={name:"签到",success:!1}):r=d>e.day&&l==o&&p==t?"":s(c,d)?"yqd":"csd",e.datatextlist.push({name:"<span class='"+r+"'>"+d+"</span>"})}else r="",e.datatextlist.push({name:"<span class='"+r+"'></span>"})})},e.switchM=function(t){if("left"==t){var o=e.month-1;o<=0?(e.year=e.year-1,e.month=12,e.getqdlist(e.year,e.month)):(e.month=o,e.getqdlist(e.year,e.month))}else{var o=e.month+1;(o<=l||p>e.year)&&(o>12?(e.year=e.year+1,e.month=1,e.getqdlist(e.year,e.month)):(e.month=o,e.getqdlist(e.year,e.month)))}},e.pointbtn=function(){a.ionicLoading(),a.getDataget("mySign","",function(t){a.console(t),n.hide(),a.ionicLoading(2e3,t.msg),e.getqdlist(e.year,e.month),a.getDataget("showAccount","",function(t){a.console(t),e.userUserInfoData=t.data.userCredit})}),e.pointstate={name:"已签到",success:!0}},e.getqdlist(e.year,e.month),i.fromTemplateUrl("my-modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.modal=t}),e.openModal=function(){e.modal.show()},e.closeModal=function(){e.modal.hide()},e.$on("$destroy",function(){e.modal.remove()}),e.$on("$ionicView.leave",function(){e.modal.hide()})}]).controller("PointlistCtrl",["$scope","$timeout","$rootScope","Services","$ionicPopup","$ionicLoading","$state","$stateParams","$ionicScrollDelegate",function(e,t,o,a,n,i,s,r,c){angular.fromJson(sessionStorage.userinfo);e.myintegral={},e.pageNumber=0,e.pageSize=10,e.pointType=0,e.moredata=!1,e.findetailslists=[{name:"全部",success:!0},{name:"收入",success:!1},{name:"支出",success:!1}];var d=[];e.findetailsfun=function(t){e.pageNumber=0,d=[],e.pointType=t,c.scrollTop();for(var o=0;o<e.findetailslists.length;o++)o==t?e.findetailslists[o].success=!0:e.findetailslists[o].success=!1;e.loadMore()},e.doRefresh=function(){e.pageNumber=0,d=[],e.loadMore()},e.loadMore=function(){a.ionicLoading(),e.pageNumber+=1;var t={type:e.pointType,pageSize:e.pageSize,pageNumber:e.pageNumber};a.getReturnData("my_integral_detail",t).then(function(t){if(i.hide(),a.console(t),"0000"==t.data.code||"1010"==t.data.code||"1000"==t.data.code){a.console(t.data.data.userCreditLogList),d=d.concat(t.data.data.userCreditLogList),e.pointdetails=d;var o=t.data.data.userCreditLogList.length;o<e.pageSize?e.moredata=!0:e.moredata=!1,e.$broadcast("scroll.infiniteScrollComplete"),e.$broadcast("scroll.refreshComplete")}else a.ionicpopup("",t.msg)},function(t){return i.hide(),a.console(t),"401"==t.status?(e.optionsPopup=n.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",s.go("login")}}]}),!1):void a.ionicpopup("","错误500<br>"+t.data.message)})}}]).controller("SettingCtrl",["$scope","$timeout","$stateParams","$state","Services","$ionicPopup",function(e,t,o,a,n,i){e.settingdata={},e.userAccount={},e.userCredit={},n.getDataget("showAccount","",function(t){n.console(t),e.settingdata=t.data.userInfo,e.userAccount=t.data.userAccount,e.userCredit=t.data.userCredit}),e.exitfun=function(){n.getDataget("logout","",function(t){n.console(t),sessionStorage.token="",sessionStorage.__tempCache="",sessionStorage.userinfo="",e.optionsPopup=i.show({template:"<h4>温馨提示</h4><p>账号退出成功</p>",title:"温馨提示",scope:e,buttons:[{text:"重新登录",type:"calm",onTap:function(e){a.go("login")}}]})})}}]).controller("AutoinvestCtrl",["$scope","$timeout","$stateParams","$state","Services","$ionicPopup","$ionicLoading",function(e,t,o,a,n,i,s){n.ionicLoading(),e.data={tenderMoneyType:3,status:2,lowestApr:1,mostApr:24,lowestNum:1,mostNum:60,lowestTender:"",mostTender:"",bestChoose:"",bestStrategy:""},e.redbtext="请选择",e.jxqtext="请选择",e.data.autoswitch=!0,e.redbdatalist=[{text:"优先使用红包",value:1},{text:"优先使用加息券",value:2}],e.raisedatalist=[{text:"年化或者红包金额优先",value:1},{text:"有效期优先",value:2}],e.settingdata=angular.fromJson(sessionStorage.userinfo),e.userInfo={},e.userAccount={},e.userCredit={},n.getDataget("showAccount","",function(o){s.hide(),n.console(o),e.userInfo=o.data.userInfo,e.userAccount=o.data.userAccount,e.userCredit=o.data.userCredit,n.getData("toAutoTenderSetting",1,"",function(o){"0000"==o.code?(console.log(o),o.data.autoTenderSetting&&(e.data.lowestApr=o.data.autoTenderSetting.lowestApr,e.data.lowestMoney=o.data.autoTenderSetting.lowestMoney,e.data.lowestNum=o.data.autoTenderSetting.lowestNum,e.data.lowestTender=o.data.autoTenderSetting.lowestTender,e.data.mostApr=o.data.autoTenderSetting.mostApr,e.data.mostNum=o.data.autoTenderSetting.mostNum,e.data.mostTender=o.data.autoTenderSetting.mostTender,o.data.autoTenderSetting.bestChoose&&(e.redbtext=e.redbdatalist[o.data.autoTenderSetting.bestChoose-1].text,e.data.bestChoose=e.redbdatalist[o.data.autoTenderSetting.bestChoose-1].value),o.data.autoTenderSetting.bestStrategy&&(e.jxqtext=e.raisedatalist[o.data.autoTenderSetting.bestStrategy-1].text,e.data.bestStrategy=e.raisedatalist[o.data.autoTenderSetting.bestStrategy-1].value),1==o.data.autoTenderSetting.status?e.data.autoswitch=!0:e.data.autoswitch=!1),t(function(){$(".range-slider1").jRange({from:1,to:24,isnum:1,step:1,scale:[1,24],format:"%s",width:288,showLabels:!0,isRange:!0}),$(".range-slider2").jRange({from:1,to:60,isnum:2,step:1,scale:[1,60],format:"%s",width:288,showLabels:!0,isRange:!0})},100)):n.ionicLoading(2e3,o.msg)})});var r=document.getElementById("redb"),c=new Picker({data:[e.redbdatalist]});c.on("picker.select",function(t,o){r.innerText=e.redbdatalist[o[0]].text}),c.on("picker.change",function(e,t){}),c.on("picker.valuechange",function(t,o){e.data.bestChoose=t[0]}),c.on("picker.cancel",function(){e.data.bestChoose="",r.innerText="点击选择"}),r.addEventListener("click",function(){c.show()});var d=document.getElementById("select_jxq"),u=new Picker({data:[e.raisedatalist]});u.on("picker.select",function(t,o){d.innerText=e.raisedatalist[o[0]].text}),u.on("picker.change",function(e,t){}),u.on("picker.valuechange",function(t,o){e.data.bestStrategy=t[0]}),u.on("picker.cancel",function(){e.data.bestStrategy="",d.innerText="点击选择"}),d.addEventListener("click",function(){u.show()}),e.autoinvestfun=function(){return n.ionicLoading(),e.data.bestChoose?e.data.bestStrategy?(e.data.lowestApr=parseInt($(".firstnum").html()),e.data.mostApr=parseInt($(".lastnum").html()),e.data.lowestNum=parseInt($(".firstnum1").html()),e.data.mostNum=parseInt($(".lastnum1").html()),e.data.autoswitch?e.data.status=1:e.data.status=2,void n.getData("autoTenderSetting",1,e.data,function(t){s.hide(),"0000"==t.code?e.optionsPopup=i.show({template:"设置成功",title:"温馨提示",scope:e,buttons:[{text:"返回",onTap:function(e){a.go("setting")}}]}):n.ionicLoading(2e3,t.msg)})):(n.ionicLoading(2e3,"请选择优惠策略"),!1):(n.ionicLoading(2e3,"请选择优惠券"),!1)}}]).controller("SetusernameCtrl",["$scope","$timeout","$ionicPopup","$state","Services",function(e,t,o,a,n){e.data={},e.bindusername=function(){n.ionicLoading(),n.getData("bindingnickname",1,e.data,function(t){$ionicLoading.hide(),e.optionsPopup=o.show({template:"设置成功",title:"温馨提示",scope:e,buttons:[{text:"返回",onTap:function(e){a.go("setting")}}]});
})}}]).controller("ManageaddressCtrl",["$scope","$timeout","$rootScope","Services","$ionicPopup","$ionicLoading","$state","$stateParams",function(e,t,o,a,n,i,s,r){e.data={};var c=angular.fromJson(sessionStorage.userinfo);e.data.name=c.realname,e.data.phone=c.username,e.manageaddressfun=function(){a.ionicLoading();var t={userNo:c.userNo,address:e.data.addr+e.data.addres};a.getData("A083",t).success(function(e){i.hide()})},$(function(){function t(e){var t=[];if(void 0!=addr_arr[e])return addr_arr[e].forEach(function(e){t.push({key:e[0],val:e[1]})}),t}function o(e,t){var o=0;return void 0!=e&&e.forEach(function(e,a){if(e.key==t)return o=a,!1}),o}$("#myAddrs").click(function(){var a=[],n=[],i=[];addr_arr[0].forEach(function(e){a.push({key:e[0],val:e[1]})});var s=$(this),r=s.attr("data-key"),c=1,d=36,u=37,l=0,p=0,g=0;if(""!=r&&void 0!=r){var m=r.split("-");3==m.length?(c=m[0],d=m[1],u=m[2]):2==m.length&&(c=m[0],d=m[1]),n=t(c),i=t(d),g=o(a,c),p=o(n,d),l=o(i,u)}var f=[{title:"省",id:"scs_items_prov"},{title:"市",id:"scs_items_city"},{title:"区",id:"scs_items_dist"}];SCS.init({navArr:f,onOk:function(t,o){e.data.addr=o.replace(/\s+/g,""),s.val(o).attr("data-key",t)}});var h=new SCS.scrollCascadeSelect({el:"#"+f[2].id,dataArr:i,startIndex:l}),b=new SCS.scrollCascadeSelect({el:"#"+f[1].id,dataArr:n,startIndex:p,onChange:function(e,o){h.render(t(e.key),0)}});new SCS.scrollCascadeSelect({el:"#"+f[0].id,dataArr:a,startIndex:g,onChange:function(e,o){b.render(t(e.key),0),h.render(t(b.getSelectedItem().key),0)}})})})}]).controller("ModifyemailCtrl",["$scope","$timeout","$rootScope","Services","$ionicPopup","$ionicLoading","$state","$stateParams",function(e,t,o,a,n,i,s,r){e.data={},a.getDataget("showAccount","",function(t){a.console(t),e.userInfosession=t.data.userInfo});var c={email:""};e.getemailCodefun=function(){e.data.email?(a.ionicLoading(),c.email=e.data.email,a.getData("noauth/sendEmail",1,e.data,function(t){i.hide(),"0000"==t.code?(o.timer(60,"#sendButton_reg"),e.optionsPopup=n.show({template:"发送成功",title:"温馨提示",scope:e,buttons:[{text:"确定"}]})):a.ionicLoading(2e3,t.msg)})):a.ionicLoading(2e3,"请输入邮箱")},e.getphoneCodefun=function(){if(e.data.phone){a.ionicLoading();var t={userName:e.data.phone,type:2};a.getData("noauth/sendMessage",1,t,function(t){i.hide(),"0000"==t.code?(o.timer(60,"#sendButton_reg"),e.optionsPopup=n.show({template:"发送成功",title:"温馨提示",scope:e,buttons:[{text:"确定"}]})):a.ionicLoading(2e3,t.msg)})}else a.ionicLoading(2e3,"请输入手机号")},e.bindemail=function(){a.ionicLoading(),a.getData("bindingemail",1,e.data,function(t){i.hide(),"0000"==t.code?e.optionsPopup=n.show({template:"绑定成功",title:"温馨提示",scope:e,buttons:[{text:"返回",onTap:function(e){s.go("setting")}}]}):a.ionicLoading(2e3,t.msg)})},e.exitbindemail=function(){a.ionicLoading(),a.getData("bindingemail",1,e.data,function(t){i.hide(),"0000"==t.code?e.optionsPopup=n.show({template:"绑定成功",title:"温馨提示",scope:e,buttons:[{text:"返回",onTap:function(e){s.go("setting")}}]}):a.ionicLoading(2e3,t.msg)})}}]).controller("MytransferCtrl",["$scope","$timeout","Services",function(e,t,o){e.prolisttit=[{name:"默认",numday:0,success:!0},{name:"近7天",numday:7,success:!1},{name:"近1个月",numday:30,success:!1},{name:"近2个月",numday:60,success:!1},{name:"近6个月",numday:180,success:!1},{name:"近1年",numday:365,success:!1}],t(function(){new Swiper(".swiper-container",{pagination:".swiper-pagination",slidesPerView:4,paginationClickable:!0,spaceBetween:0,freeMode:!0})},500),e.moredata=!1,e.pageNumber=0,e.pageSize=10;var a=angular.fromJson(sessionStorage.userinfo),n=[],i={userId:a.id,userNo:a.userNo,startTime:"",endTime:"",tenderStatus:0,pageNumber:e.pageNumber,pageSize:e.pageSize};e.getMoneyData=function(t){o.getData("A029",t).success(function(t){"000000"==t.respHead.respCode&&(n=[],e.financialData=t.body.list?t.body.list:[]),1==t.body.totalPage?e.moredata=!0:e.moredata=!1,e.pageNumber=0})["finally"](function(){e.$broadcast("scroll.refreshComplete")})},e.doRefresh=function(){i={userId:a.id,userNo:a.userNo,tenderStatus:0,pageNumber:e.pageNumber,pageSize:e.pageSize}},e.loadMore=function(){e.pageNumber+=1,i.pageNumber=e.pageNumber,i.pageSize=e.pageSize,o.getData("A029",i).success(function(t){"000000"==t.respHead.respCode&&(n=n.concat(t.body.list?t.body.list:[]),e.financialData=n,e.pageNumber>=t.body.totalPage&&(e.moredata=!0),e.$broadcast("scroll.infiniteScrollComplete"))}).error(function(){})},e.protittopfc=function(t){e.financialData=[],n=[],e.pageNumber=0,0==t?(i.startTime="",i.endTime=""):o.getServerTime(e.prolisttit[t].numday,function(e){var t=e.split("_");i.startTime=t[0],i.endTime=t[1]});for(var a=0,s=e.prolisttit.length;a<s;a++)t===a?(e.prolisttit[a].success=!0,e.moredata=!1):e.prolisttit[a].success=!1}}]).controller("MytransferlistCtrl",["$scope","$timeout","Services",function(e,t,o){e.prolisttit=[{name:"默认",numday:0,success:!0},{name:"近7天",numday:7,success:!1},{name:"近1个月",numday:30,success:!1},{name:"近2个月",numday:60,success:!1},{name:"近6个月",numday:180,success:!1},{name:"近1年",numday:365,success:!1}],e.borrowstatelists=[{name:"转让中",success:!0},{name:"已完成",success:!1},{name:"已承接",success:!1}],t(function(){new Swiper(".swiper-container",{pagination:".swiper-pagination",slidesPerView:4,paginationClickable:!0,spaceBetween:0,freeMode:!0})},500),e.moredata=!1,e.pageNumber=0,e.pageSize=10;var a=angular.fromJson(sessionStorage.userinfo),n=[],i={userId:a.id,userNo:a.userNo,startTime:"",endTime:"",tenderStatus:0,pageNumber:e.pageNumber,pageSize:e.pageSize};e.getMoneyData=function(t){o.getData("A020",t).success(function(t){"000000"==t.respHead.respCode&&(n=[],e.financialData=t.body.list?t.body.list:[]),1==t.body.totalPage?e.moredata=!0:e.moredata=!1,e.pageNumber=0})["finally"](function(){e.$broadcast("scroll.refreshComplete")})},e.doRefresh=function(){i={userId:a.id,userNo:a.userNo,tenderStatus:0,pageNumber:e.pageNumber,pageSize:e.pageSize};for(var t=e.borrowstatelists.length-1;t>=0;t--)e.borrowstatelists[t].success&&(i.tenderStatus=t,i.pageNumber=1,e.getMoneyData(i))},e.loadMore=function(){e.pageNumber+=1,i.pageNumber=e.pageNumber,i.pageSize=e.pageSize,o.getData("A020",i).success(function(t){"000000"==t.respHead.respCode&&(n=n.concat(t.body.list?t.body.list:[]),e.financialData=n,e.pageNumber>=t.body.totalPage&&(e.moredata=!0),e.$broadcast("scroll.infiniteScrollComplete"))}).error(function(){})},e.protittopfc=function(t){e.financialData=[],n=[],e.pageNumber=0,0==t?(i.startTime="",i.endTime=""):o.getServerTime(e.prolisttit[t].numday,function(e){var t=e.split("_");i.startTime=t[0],i.endTime=t[1]});for(var a=0,s=e.prolisttit.length;a<s;a++)t===a?(e.prolisttit[a].success=!0,e.moredata=!1):e.prolisttit[a].success=!1},e.borrowstatefun=function(t){e.financialData=[],n=[],e.pageNumber=0;for(var o=0,a=e.borrowstatelists.length;o<a;o++)t===o?(i.tenderStatus=o,e.moredata=!1,e.borrowstatelists[o].success=!0):e.borrowstatelists[o].success=!1}}]).controller("InvitefriendsCtrl",["$scope","$timeout","Services",function(e,t,o){e.data={},o.getDataget("invitingFriends","",function(t){o.console(t),e.data=t.data}),o.getData("invitationRecord",1,"",function(t){o.console(t),e.invitelists=t.data}),e.invitedbtn=function(){o.ionicLoading(2e3,"复制成功,您可以使用粘贴操作了！")}}]).controller("BankcardCtrl",["$scope","$timeout","Services",function(e,t,o){e.data={};angular.fromJson(sessionStorage.userinfo);$(function(){function t(e){var t=[];if(void 0!=addr_arr[e])return addr_arr[e].forEach(function(e){t.push({key:e[0],val:e[1]})}),t}function o(e,t){var o=0;return void 0!=e&&e.forEach(function(e,a){if(e.key==t)return o=a,!1}),o}$("#myAddrs").click(function(){var a=[],n=[],i=[];addr_arr[0].forEach(function(e){a.push({key:e[0],val:e[1]})});var s=$(this),r=s.attr("data-key"),c=1,d=36,u=37,l=0,p=0,g=0;if(""!=r&&void 0!=r){var m=r.split("-");3==m.length?(c=m[0],d=m[1],u=m[2]):2==m.length&&(c=m[0],d=m[1]),n=t(c),i=t(d),g=o(a,c),p=o(n,d),l=o(i,u)}var f=[{title:"省",id:"scs_items_prov"},{title:"市",id:"scs_items_city"},{title:"区",id:"scs_items_dist"}];SCS.init({navArr:f,onOk:function(t,o){e.data.addr=o.replace(/\s+/g,""),s.val(o).attr("data-key",t)}});var h=new SCS.scrollCascadeSelect({el:"#"+f[2].id,dataArr:i,startIndex:l}),b=new SCS.scrollCascadeSelect({el:"#"+f[1].id,dataArr:n,startIndex:p,onChange:function(e,o){h.render(t(e.key),0)}});new SCS.scrollCascadeSelect({el:"#"+f[0].id,dataArr:a,startIndex:g,onChange:function(e,o){b.render(t(e.key),0),h.render(t(b.getSelectedItem().key),0)}})})})}]),angular.module("home.controllers",["services"]).controller("HomeCtrl",["$scope","$timeout","$state","Services","$ionicLoading",function(e,t,o,a,n){localStorage.guide||o.go("guide"),e.goprodetail=function(e){o.go("prodetail",{proid:e,curside:"1"})},e.noticelink=function(e){o.go("newsdetail",{newsid:e})},a.ionicLoading();var i={type:1,count1:1,count2:2,count3:999,code:"platform_info"};a.getData("noauth/bannerShow",6e4,i,function(o){if(o.data.data){e.homebannerlists=o.data.data,e.xslist=o.data.recommendBorrow,e.borrowInfoPage=o.data.rapidInvestmentBorrow,e.noticList=o.data.articles;var a=function(e,t){Meter.setOptions({element:"meter"+e,centerPoint:{x:90,y:90},radius:90,data:{value:100*t,title:"投资进度(%)",subTitle:"",area:[{min:0,max:25,text:""},{min:25,max:50,text:""},{min:50,max:75,text:""},{min:75,max:100,text:""}]}}).init()};t(function(){new Swiper(".swiper-container1",{pagination:".swiper-pagination",paginationClickable:!0,autoHeight:!0,autoplay:3e3,autoplayDisableOnInteraction:!1,loop:!0}),new Swiper(".swiper-container3",{pagination:".swiper-pagination",autoplay:2e3,autoplayDisableOnInteraction:!1,loop:!0}),new Swiper(".swiper-container2",{pagination:".swiper-pagination",paginationClickable:!0,onSlideChangeStart:function(t){a(t.activeIndex,e.borrowInfoPage[t.activeIndex].planRat)}});a(0,e.borrowInfoPage[0].planRat)},100)}})}]).controller("GuideCtrl",["$scope","HomeServices","$timeout","$state","Services","$ionicLoading",function(e,t,o,a,n,i){localStorage.guide&&a.go("tab.home"),e.enterfun=function(){localStorage.guide="2017-3-23 15:44:00",a.go("tab.home")}}]).controller("MoreCtrl",["$scope","HomeServices","$timeout","$state","Services","$ionicLoading",function(e,t,o,a,n,i){}]).controller("FeedbackCtrl",["$scope","HomeServices","$timeout","$state","Services","$ionicPopup",function(e,t,o,a,n,i){e.data={};angular.fromJson(sessionStorage.userinfo);e.feedbackbtn=function(){n.getData("messageFeedback",1,e.data,function(t){n.console(t),"0000"==t.code?e.optionsPopup=i.show({template:"<h4>反馈成功</h4><p>感谢您的宝贵意见，我们尽快改正。</p>",title:"温馨提示",scope:e,buttons:[{text:"返回",type:"calm",onTap:function(t){e.data.content="",a.go("more")}}]}):n.ionicLoading(2e3,t.msg)})}}]).controller("securityCtrl",["$scope","HomeServices","$timeout","$state","Services","$ionicLoading",function(e,t,o,a,n,i){e.pageNumber=0,e.pageSize=10,e.moredata=!1;var s=[];e.doRefresh=function(){e.pageNumber=0,s=[],e.loadMore()},e.loadMore=function(){n.ionicLoading(),e.pageNumber+=1;var t={count:e.pageSize,pageNumber:e.pageNumber,code:"industry_info"};n.getReturnData("noauth/newsShow",t).then(function(t){if(i.hide(),n.console(t),"0000"==t.data.code||"1010"==t.data.code||"1000"==t.data.code){n.console(t.data.data.articles),s=s.concat(t.data.data.articles),e.pointdetails=s;var o=t.data.data.articles.length;o<e.pageSize?e.moredata=!0:e.moredata=!1,e.$broadcast("scroll.infiniteScrollComplete"),e.$broadcast("scroll.refreshComplete")}else n.ionicpopup("",t.msg)},function(t){return i.hide(),n.console(t),"401"==t.status?(e.optionsPopup=$ionicPopup.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",a.go("login")}}]}),!1):void n.ionicpopup("","错误"+t.status+"<br>"+t.data.message)})},e.linknews=function(e){a.go("newsdetail",{newsid:e})}}]).controller("newsdetailCtrl",["$scope","HomeServices","$stateParams","$state","Services","$ionicLoading",function(e,t,o,a,n,i){if(n.ionicLoading(),o.newsid){var s={id:o.newsid};n.getReturnData("noauth/newsShowDetail",s).then(function(t){i.hide(),n.console(t),"0000"==t.data.code||"1010"==t.data.code||"1000"==t.data.code?e.newdetaildata=t.data.data.article:n.ionicpopup("",t.msg)},function(t){return i.hide(),n.console(t),"401"==t.status?(e.optionsPopup=$ionicPopup.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",a.go("login")}}]}),!1):void n.ionicpopup("","错误500<br>"+t.data.message)})}else n.ionicpopup("","没有参数")}]).controller("noticeCtrl",["$scope","HomeServices","$timeout","$state","Services","$ionicLoading",function(e,t,o,a,n,i){e.pageNumber=0,e.pageSize=10,e.moredata=!1;var s=[];e.doRefresh=function(){e.pageNumber=0,s=[],e.loadMore()},e.loadMore=function(){n.ionicLoading(),e.pageNumber+=1;var t={count:e.pageSize,pageNumber:e.pageNumber,code:"platform_info"};n.getReturnData("noauth/newsShow",t).then(function(t){if(i.hide(),n.console(t),"0000"==t.data.code||"1010"==t.data.code||"1000"==t.data.code){n.console(t.data.data.articles),s=s.concat(t.data.data.articles),e.pointdetails=s;var o=t.data.data.articles.length;o<e.pageSize?e.moredata=!0:e.moredata=!1,e.$broadcast("scroll.infiniteScrollComplete"),e.$broadcast("scroll.refreshComplete")}else n.ionicpopup("",t.msg)},function(t){return i.hide(),n.console(t),"401"==t.status?(e.optionsPopup=$ionicPopup.show({template:"登录过期，请重新登录",title:"温馨提示",scope:e,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",a.go("login")}}]}),!1):void n.ionicpopup("","错误"+t.status+"<br>"+t.data.message)})},e.linknews=function(e){a.go("newsdetail",{newsid:e})}}]).controller("problemsCtrl",["$scope","HomeServices","$timeout","$state","Services","$ionicLoading",function(e,t,o,a,n,i){var s={count:100,comment:2,code:"common_problem"};n.getData("noauth/newsShow",60,s,function(t){n.console(t),e.helplists=t.data.articles;for(var o=0;o<e.helplists.length;o++)e.helplists[o].success=!1}),e.findetailsfun=function(t){for(var o=0;o<e.helplists.length;o++)t!=o&&(e.helplists[o].success=!1);e.helplists[t].success=!e.helplists[t].success}}]).controller("LeaderboardCtrl",["$scope","$state","$ionicHistory","$ionicPopup","Services","$ionicLoading",function(e,t,o,a,n,i){var s={count:20};e.datatop=[],e.databot=[],n.getData("noauth/heroRank_xnk",10,s,function(t){if(n.console(t),e.data=t.data.userToRank,e.data.length<=3)e.datatop=e.data;else for(var o=0;o<e.data.length;o++)o<3?e.datatop.push(e.data[o]):e.databot.push(e.data[o])})}]).controller("CallbackCtrl",["$scope","$timeout","$state","Services","$ionicLoading","$location","$interval",function(e,t,o,a,n,i,s){e.data={time:4,msg:i.search().msg,token:i.search().token,code:i.search().code,tab:i.search().tab},i.search().token&&(sessionStorage.token=i.search().token),e.linkfun=function(){o.go("tab.my"),s.cancel(e.linktime)},e.linktime=setInterval(function(){e.data.time<=0?(e.data.time="0",e.linkfun()):e.data.time--},1e3)}]).controller("AboutlistCtrl",["$scope","HomeServices","$timeout","$state","Services","$ionicLoading",function(e,t,o,a,n,i){e.historydatas=[{time:"2017.11",text:"e聚富总投资额突破3亿元"},{time:"2017.09",text:"e聚富线上车贷业务正式上线"},{time:"2017.09",text:"e聚富与中国平安银行签订银行存管协议"},{time:"2017.05",text:"e聚富总投资额突破2亿元"},{time:"2017.04",text:"汽车金融服务平台，四川分公司各单店交易额超1亿元"},{time:"2016.09",text:"e聚富总投资额突破1亿元"},{time:"2016.08",text:"汽车金融服务平台，江西吉安店年交易额5000万元"},{time:"2016.08",text:"e聚富获得EDI&ICP电信增值业务许可证"},{time:"2015.11",text:"汽车金融服务平台，湖州店年交易额8000万元"},{time:"2015.09",text:"汽车金融服务平台，衢州店年交易额1.1亿元"},{time:"2015.07",text:"e聚富总投资额突破1000万元"},{time:"2015.05",text:"e聚富APP正式上线"},{time:"2015.03",text:"e聚富网络借贷平台上线试运营"},{time:"2015.01",text:"杭州泉水金融信息服务有限公司注册成立，注册资金2000万元"},{time:"2014.08",text:"汽车金融服务平台正式成立"},{time:"2014.08",text:"浙江鑫爵晟金融信息服务有限公司注册成立，注册资金2000万元"}],n.getDataget("noauth/companyInfor","",function(t){e.aboutdata=t.data.list})}]).controller("integralmallCtrl",["$scope","HomeServices","$timeout","$state","Services","$ionicLoading",function(e,t,o,a,n,i){if(sessionStorage.userinfo){var s={type:"1"},r=angular.fromJson(sessionStorage.userinfo);e.integurl="/apis/jfsc/webapp/goods.html?source=app&userId="+r.id+"&sign=B78565A43A7D437267BAAB685B6E5F9D",n.getData("A007",s).success(function(e){}),e.Hbody=$(window).height();document.getElementById("iframe")}else a.go("login")}]),angular.module("CacheService",[]).factory("cacheService",["$rootScope","$http","$q",function(e,t,o){return{console:function(t){e.debug&&(console.log(t),e.debugtrace&&console.trace())},getCache:function(){var e,t=sessionStorage.getItem("__tempCache");if(t)try{e=JSON.parse(t)}catch(o){e={}}else e={},sessionStorage.setItem("__tempCache",JSON.stringify(e));return e},setCache:function(e,t){var o=this.getCache();o[e]=t,sessionStorage.setItem("__tempCache",JSON.stringify(o))},removeCache:function(e){var t=this.getCache();t[e]&&(delete t[e],sessionStorage.setItem("__tempCache",JSON.stringify(t)))},cacheObject:function(e,t,a,n,i){var s=this,r=o.defer(),c=r.promise;c.success=function(e){return c.then(e),c},c.error=function(e){return c.then(null,e),c};var d=this.getCacheObject(e);if(d)r.resolve(d);else{a.apply(n,i).success(function(o){"1111"!=o.code&&"1111"!=o.code&&"1111"!=o.code||s.putCache(e,t,o),r.resolve(o)}).error(function(e){r.reject(e)})}return r.promise},getCacheObject:function(e){var t,o=this.getCache();if(o[e]){var a=o[e];a.period>0?this.getTimestamp(new Date)-a.createTime<=a.period&&(t=a.data):t=a.data}return t},putCache:function(e,t,o){var a={key:e,createTime:this.getTimestamp(new Date),period:t,data:o};this.setCache(e,a)},getTimestamp:function(e){return Math.round(e.getTime()/1e3)}}}]),angular.module("home.services",["services"]).service("HomeServices",["Services","$rootScope","$http","cacheService",function(e,t,o,a){return{getHomeData:function(a){var n={reqHead:{functionId:"",terminalType:"3",terminalId:"",transTime:e.getNowTime(),version:"1.0.0",clientIp:""},body:{}};o.post(t.homeUrl,angular.toJson(n)).success(function(e){return a(e)})}}}]),angular.module("money.services",[]).service("MoneyServices",["$rootScope","Services","cacheService","$http",function(e,t,o,a){return{getMoney:function(n,i,s,r,c,d,u){var l={reqHead:{functionId:n,terminalType:"3",terminalId:"",transTime:t.getNowTime(),version:"1.0.0",clientIp:""},body:{pageNumber:i,pageSize:s,nhsyOrder:r,qixianOrder:c,moneyOrder:d,touzijinduOrder:u}};return o.cacheObject("homebanner",600,a.post,this,[e.baseUrl,angular.toJson(l)])}}}]),angular.module("my.services",[]).service("MyServices",["$rootScope","Services","cacheService","$http",function(e,t,o,a){return{getUserredb:function(n,i,s,r,c,d){var u={reqHead:{functionId:n,terminalType:"3",terminalId:"",transTime:t.getNowTime(),version:"1.0.0",clientIp:""},body:{userId:i,userNo:s,redPaperStatus:r,pageNumber:c,pageSize:d}};return o.cacheObject("phoneCode",0,a.post,this,[e.baseUrl,angular.toJson(u)])},getUserticket:function(n,i,s,r,c,d){var u={reqHead:{functionId:n,terminalType:"3",terminalId:"",transTime:t.getNowTime(),version:"1.0.0",clientIp:""},body:{userId:i,userNo:s,status:r,pageNumber:c,pageSize:d}};return o.cacheObject("phoneCode",0,a.post,this,[e.baseUrl,angular.toJson(u)])}}}]),angular.module("services",[]).service("Services",["$http","$rootScope","cacheService","$ionicLoading","$ionicPopup","$state","$filter","$interval",function(e,t,o,a,n,i,s,r){return{ionicLoading:function(e,t){e||(e=1e4),t||(t="<img width='80' src='img/loading.gif'>"),a.show({template:t,hideOnStateChange:!0,duration:e})},console:function(e){t.debug&&console.log(e)},islogin:function(){return!!sessionStorage.token||(t.optionsPopup=n.show({template:"您未登入，是否立即登入",title:"温馨提示",rootScope:t,buttons:[{text:"返回",onTap:function(e){$ionicHistory.goBack()}},{text:"立即登入",type:"calm",onTap:function(e){i.go("login")}}]}),!1)},zhtime:function(e){var t=new Date,o="-",a=":",n=t.getMonth()+1,i=t.getDate();n>=1&&n<=9&&(n="0"+n),i>=0&&i<=9&&(i="0"+i);var s=t.getFullYear()+o+n+o+i+" "+t.getHours()+a+t.getMinutes()+a+t.getSeconds(),r=e.split(" "),c=angular.toJson(r[1]),d=angular.toJson(r[0]),u=c.split(":"),l=d.split("-"),p=s.split(" "),g=angular.toJson(p[1]),m=angular.toJson(p[0]),f=g.split(":"),h=m.split("-"),b=(l[1]+"/"+l[2]).substring(0,5);return h[0].split('"')[1]-l[0].split('"')[1]>0?b:h[1]-l[1]>0?b:h[2].split('"')[0]-l[2].split('"')[0]>0?b:f[0].split('"')[1]-u[0].split('"')[1]>0?f[0].split('"')[1]-u[0].split('"')[1]+"小时前":f[1]-u[1]>0?f[1]-u[1]+"分钟前":f[2].split('"')[0]-u[2].split('"')[0]+"秒前"},getNowTime:function(){var e=new Date,t="",o="",a=e.getMonth()+1,n=e.getDate();a>=1&&a<=9&&(a="0"+a),n>=0&&n<=9&&(n="0"+n);var i=e.getFullYear()+t+a+t+n+e.getHours()+o+e.getMinutes()+o+e.getSeconds();return i},getServerTime:function(o){e.get(t.baseUrl+"noauth/getCurrentTime").success(function(e){return console.log(e),o(e)})},getData:function(s,c,d,u){var l=this,p="";if(sessionStorage.token)var p=sessionStorage.token;l.ionicLoading(),o.cacheObject(s,c,e.post,this,[t.baseUrl+s,d,{headers:{token:p,Clients:"wechat"}}]).then(function(e){return a.hide(),"0000"==e.code||"1010"==e.code||"1000"==e.code?u(e):void l.ionicpopup("",e.msg)},function(e){return a.hide(),"401"==e.status?(t.optionsPopup=n.show({template:"登录过期，请重新登录",title:"温馨提示",scope:t,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",i.go("login")}}]}),"refreshToken"==s&&r.cancel(t.tokentime),!1):void l.ionicpopup("","错误500"+e.message)})},getDataget:function(e,o,s){var c=this,d="";if(sessionStorage.token)var d=sessionStorage.token;c.ionicLoading(),$.ajax({url:t.baseUrl+e,data:o,beforeSend:function(e){e.setRequestHeader("token",d),e.setRequestHeader("Clients","wechat")},dataType:"JSON",type:"GET",success:function(e){return a.hide(),s(e)},error:function(o){return a.hide(),t.optionsPopup=n.show({template:"登录过期，请重新登录",title:"温馨提示",scope:t,buttons:[{text:"取消"},{text:"重新登录",type:"calm",onTap:function(e){sessionStorage.token="",sessionStorage.__tempCache="",i.go("login")}}]}),"refreshToken"==e&&r.cancel(t.tokentime),!1}})},getReturnData:function(o,a){var n="";if(sessionStorage.token)var n=sessionStorage.token;return e.post(t.baseUrl+o,a,{headers:{token:n,Clients:"wechat"}})},getupdatatx:function(a,n){var i={reqHead:{functionId:a,terminalType:"3",terminalId:"",transTime:this.getNowTime(),version:"1.0.0",clientIp:""},body:n};return o.cacheObject(a,600,e.post,this,[t.uploadtxUrl,angular.toJson(i)])},ionicpopup:function(e,t){n.alert({title:e,template:t})}}}]);